<!--
#################### WE ARE STARTING OUT WITH STATE DERIVED FRONTEND ######################

    1. State is the variable part of the app
    2. Component is how we render state on screen

-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <input type="text"></input>
  <button onclick="addTodo()" placeholder="Add todo">Add todo!</button>
  <div id="todo-container"></div>
</body>

<script>
  let todos = [];
  function addTodo() {
    const value = document.querySelector("input").value

    if (value) {
      todos.push({
        title: document.querySelector("input").value
      })
      render();
    }
    else {
      alert("Add todo can't be empty!")
    }
  }

  function deleteTodo(index) {
    todos.splice(index, 1)
    render()
  }

  function editTodo(index){
    let convert_to_div = document.getElementById("todo-"+index).querySelector("span")
    convert_to_div.parentNode.removeChild(convert_to_div)
    let user_input = document.createElement("input")
    user_input.id = `input-${index}`
    document.getElementById("todo-"+index).appendChild(user_input)
    document.getElementById("todo-"+index).querySelectorAll("button")[1].innerText = "save"
    document.getElementById("todo-"+index).querySelectorAll("button")[1].onclick = () => updateTodo(index)
  }

  function updateTodo(index){
    let value = document.getElementById("input-"+index).value
    if (value){
      todos[index].title = value
    }
    else{
      alert("edit box can't be empty!")
    }
    render ()
  }

  function render() {
    document.getElementById("todo-container").innerHTML = ''
    let todoEl
    for (let index = 0; index < todos.length; index++) {
      let todoEl = createComponent(index)
      todoEl.id = "todo-" + index
      todoEl.querySelector("span").innerText = (index + 1) + '. ' + todos[index].title
      todoEl.querySelectorAll("button")[0].innerText = "Delete"//button to delete
      todoEl.querySelectorAll("button")[1].innerText = "Edit"//button to edit todo
      document.getElementById("todo-container").appendChild(todoEl)
    }
  }

  function createComponent(index) {
    let newEl = document.createElement("div")
    let newSpan = document.createElement("span")
    let button2 = document.createElement("button")
    let button = document.createElement("button")
    newEl.appendChild(newSpan)
    newEl.appendChild(button)
    newEl.appendChild(button2)
    button.onclick = () => deleteTodo(index)
    button2.onclick = () => editTodo(index)
    return newEl
  }
</script>

</html>